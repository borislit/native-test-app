{"version":3,"sources":["server.js"],"names":["start","port","process","env","PORT","app","use","secret","resave","saveUninitialized","req","res","session","visitCount","send","listen","console","info"],"mappings":";;;;;QAIgBA,K,GAAAA,K;;AAJhB;;;;AACA;;;;AACA;;;;AAEO,SAASA,KAAT,GAAgD;AAAA,MAAjCC,IAAiC,uEAA1BC,QAAQC,GAAR,CAAYC,IAAZ,IAAoB,IAAM;;AACrD,MAAMC,MAAM,wBAAZ;;AAEAA,MAAIC,GAAJ,CACE,8BAAQ;AACNC,YAAQ,QADF;AAENC,YAAQ,IAFF;AAGNC,uBAAmB;AAHb,GAAR,CADF;;AAQAJ,MAAIC,GAAJ,CAAQ,GAAR,EAAa,UAACI,GAAD,EAAMC,GAAN,EAAc;AACzB,QAAI,CAACD,IAAIE,OAAJ,CAAYC,UAAjB,EAA6B;AAC3BH,UAAIE,OAAJ,CAAYC,UAAZ,GAAyB,CAAzB;AACD;;AAEDH,QAAIE,OAAJ,CAAYC,UAAZ;;AAEAF,QAAIG,IAAJ,CACE,kBAAS,gBAAT,EAA2B;AACzBD,kBAAYH,IAAIE,OAAJ,CAAYC;AADC,KAA3B,CADF;AAKD,GAZD;;AAcA,SAAOR,IAAIU,MAAJ,CAAWd,IAAX,EAAiB,YAAM;AAC5Be,YAAQC,IAAR,qCAA+ChB,IAA/C;AACD,GAFM,CAAP;AAGD","file":"server.js","sourcesContent":["import express from 'express';\nimport session from 'express-session';\nimport { renderVM } from './vm';\n\nexport function start(port = process.env.PORT || 3000) {\n  const app = express();\n\n  app.use(\n    session({\n      secret: 'secret',\n      resave: true,\n      saveUninitialized: true,\n    }),\n  );\n\n  app.use('/', (req, res) => {\n    if (!req.session.visitCount) {\n      req.session.visitCount = 0;\n    }\n\n    req.session.visitCount++;\n\n    res.send(\n      renderVM('./src/index.vm', {\n        visitCount: req.session.visitCount,\n      }),\n    );\n  });\n\n  return app.listen(port, () => {\n    console.info(`Fake server is running on port ${port}`);\n  });\n}\n"]}