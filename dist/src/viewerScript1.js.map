{"version":3,"sources":["viewerScript1.js"],"names":["module","exports","newCity","getWeather","newWeather","$w","props","city","weather","onCityChanged","pageReady","require","getThings","pubsub","updateCompProps","initAppForPage","initAppParam","scopedGlobalSdkApis","pubSub","nativeApi","Promise","resolve","emptyController","isViewer","subscribeToWixCode","unsubscribe","id","subscribe","data","newThings","things","isFirstTime","createApiClass","Element","superArgs","updateControllerData","setTimeout","controller","RMI","setThings","controllerByType","createControllers","controllerConfigs","map","type","isIframe","nativeCompIsIframe"],"mappings":"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","file":"viewerScript1.js","sourcesContent":["// import {getThings} from './initialState';\n\nmodule.exports = function () {\n    const {getThings} = require('./initialState');\n\n    let pubsub, updateCompProps;\n\n    function initAppForPage(initAppParam, {pubSub, nativeApi}, scopedGlobalSdkApis) {\n        pubsub = pubSub;\n        return Promise.resolve();\n    }\n\n    function emptyController() {\n        return {\n            pageReady: () => {\n            },\n            exports: {}\n        }\n    }\n\n    function isViewer() {\n        return false;\n    }\n\n    function subscribeToWixCode() {\n        if (pubsub) {\n            pubsub.unsubscribe('add_to_cart_wix_code', id);\n            id = pubsub.subscribe('add_to_cart_wix_code', ({data}) => {\n\n                $w('@this').props = {newThings: data.things};\n            }, isFirstTime);\n            //wix code run before this code only when the page is loaded in the first time\n            isFirstTime = false;\n        }\n    }\n\n    // async function pageReady($w) {\n    //     const things = await getThings();\n    //     const native = $w('@this');\n    //     native.props = {things};\n    //     if (isIframe()) {\n    //         subscribeToWixCode()\n    //     }\n    // }\n\n    const createApiClass = function (Element) {\n        return class API extends Element {\n            constructor($w, superArgs) {\n                super(...superArgs);\n                this.$w = $w;\n\n            }\n\n            set things(newThings) {\n                this.$w.updateControllerData({newThings: newThings});\n            }\n\n            get things() {\n                return [1,2,3,4,5];\n            }\n        }\n    };\n\n\n    const getWeather = function (city) {\n        return new Promise((resolve) => {\n            setTimeout(() => {\n               if (city === 'Tel Aviv') {\n                   resolve(30);\n               } else if (city === 'London') {\n                   resolve(20)\n               } else resolve(0)\n\n            }, 1000)\n        })\n    };\n\n    async function onCityChanged(newCity) {\n        const newWeather = await getWeather(newCity);\n        $w.props({\n            city: newCity,\n            weather: newWeather\n        })\n    }\n\n    async function pageReady($w) {\n        const city = 'Tel Aviv';\n        const weather = await getWeather(city);\n        $w.props({\n            city,\n            weather,\n            onCityChanged\n        });\n    }\n\n    function controller() {\n        return {\n            pageReady,\n            exports: function (RMI, $w) {\n                return {\n                    setThings: function(things) {\n                        $w.props({\n                            newThings: things,\n                        })\n                    }\n                }\n            }\n        }\n    }\n\n    const controllerByType = {\n        \"153dd52f-493b-2ae5-2506-08a492a3b838\": controller,\n        \"6fa1ef51-0aaf-40bb-9d46-d2b4b5ea7e99\": controller\n\n    };\n\n    function createControllers(controllerConfigs) {\n        return controllerConfigs.map(function ({type}) {\n            return Promise.resolve(controllerByType[type] ? controllerByType[type]() : emptyController())\n        });\n    }\n\n    function isIframe() {\n        return false;\n    }\n\n    function nativeCompIsIframe() {\n        return false;\n    }\n\n\n    return {\n        initAppForPage: initAppForPage,\n        createControllers: createControllers,\n        // exports: {\n        //     openChat: function (things) {  }\n        // }\n    };\n}();"]}